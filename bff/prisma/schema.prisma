generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

/// Model for users table
model users {
  users_id   String       @id
  name       String
  surname    String
  email      String       @unique
  nickname   String
  password   String
  join_date  DateTime     @db.Date
  portfolios portfolios[]
}

/// Model for categories table
model categories {
  categories_id String    @id
  name         String
  stocks       stocks[]
}

/// Model for stocks table
model stocks {
  isin          String      @id
  categories_id String
  name          String
  wkn           String
  symbol        String
  category      categories  @relation(fields: [categories_id], references: [categories_id])
  quotes        quotes[]
  holdings      holdings[]
}

/// Model for quotes table
model quotes {
  quotes_id    String   @id
  isin         String
  price        Decimal
  currency     String
  market_time  DateTime
  exchange     String
  stock        stocks   @relation(fields: [isin], references: [isin])
}

/// Model for portfolios table
model portfolios {
  portfolios_id String      @id
  name          String
  created_at    DateTime
  users_id      String
  user          users       @relation(fields: [users_id], references: [users_id])
  holdings      holdings[]
}

/// Model for holdings table
model holdings {
  holdings_id   String         @id
  portfolios_id String
  isin          String
  quantity      Int
  start_date    DateTime       @db.Date
  end_date      DateTime?      @db.Date
  portfolio     portfolios     @relation(fields: [portfolios_id], references: [portfolios_id])
  stock         stocks         @relation(fields: [isin], references: [isin])
  transactions  transactions[]
}

/// Model for transactions table
model transactions {
  transactions_id  String   @id
  holdings_id      String
  buy              Boolean
  transaction_time DateTime
  amount           Int
  price            Decimal
  commission       Decimal
  broker           String
  holding          holdings @relation(fields: [holdings_id], references: [holdings_id])
}
